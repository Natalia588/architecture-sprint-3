@startuml
title Configuration Service

top to bottom direction

!includeurl https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/master/C4_Component.puml

Container_Boundary(ConfigurationService, "Configuration Service") {
    Component(restController, "REST API Controller", "Handles REST API requests for configuration")
    Component(serviceLayer, "Command Handler", "Business logic - handle commands")
    Component(manager, "Device Manager", "Manage devices")
    Component(repoLayer, "DB Repository Layer", "Data access logic")
    Component(redisRepo, "Redis repository", "Redis access logic")
}

Container(db, "Database", "PostgreSQL", "Stores config data")
Container(cache, "Cache", "Redis", "Cache")
Container(message_bus, "Message Bus", "Kafka", "Transport for devices events")

Rel_D(restController, serviceLayer, "Call business logic")
Rel_R(serviceLayer, manager, "Send commands")
Rel_R(manager, message_bus, "Write commands to vendors-devices topics")
Rel_D(serviceLayer, repoLayer, "Reads/Writes data")
Rel_D(serviceLayer, redisRepo, "Reads/Writes data from cache")
Rel_D(repoLayer, db, "Reads/Writes data")
Rel_D(redisRepo, cache, "Reads/Writes data")


@enduml